<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
     <!-- Compiled and minified CSS -->
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

     <!-- Compiled and minified JavaScript -->
     <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
<style>

img {

    width: 150px;
}



</style>
    <script>
 
 

class libro {
    
    constructor(titolo, autore, anno, url) {
        
        this.titolo = titolo
        this.autore = autore
        this.anno = anno
        this.url = url
    }
}

window.onload = gestoreLoad

function gestoreLoad(){

    
   


books = []
let b1 = new libro ("L'amica geniale", "Ferrante", 2009, "https://m.media-amazon.com/images/I/414t9eBUITL._SY445_SX342_.jpg")
let b2 = new libro ("L'amore molesto", "Ferrante", 2018, "https://m.media-amazon.com/images/I/A1GrLOpYKQL._AC_UY436_FMwebp_QL65_.jpg")
let b3 = new libro("Spatriati", "Desiati", 2020, "https://m.media-amazon.com/images/I/41RGtWIzyZL._SY445_SX342_.jpg")
let b4 = new libro("Il nome della Rosa", "Eco", 1995, "https://m.media-amazon.com/images/I/61Aa9Yic8AL._AC_UY436_FMwebp_QL65_.jpg")
let b5 = new libro("Non ti muovere", "Mazzantini", 2000, "https://m.media-amazon.com/images/I/61Yq06j+j4L._AC_UY436_FMwebp_QL65_.jpg")
books.push(b1)
books.push(b2)
books.push(b3)
books.push(b4, b5)
let nodoTab = document.getElementById("tab")
function popolaTabella() {

    rimuoviFigli(nodoTab)

for (let i = 0; i < books.length; i++){

    let nodoTr = document.createElement("tr")
    let nodoPos = document.createElement("td")
    nodoPos.textContent = i+1
    let nodoTitolo = document.createElement("td")
    nodoTitolo.textContent = books[i].titolo
    let nodoAutore = document.createElement("td")
    nodoAutore.textContent = books[i].autore
    let nodoAnno = document.createElement("td")
    nodoAnno.textContent = books[i].anno
    let nodoImg = document.createElement("td")
    let img = document.createElement("img")
    img.src = books[i].url
    nodoImg.appendChild(img)
    nodoTr.appendChild(nodoPos)
    nodoTr.appendChild(nodoTitolo)
    nodoTr.appendChild(nodoAutore)
    nodoTr.appendChild(nodoAnno)
    nodoTr.appendChild(nodoImg)
    nodoTab.appendChild(nodoTr)


}}
popolaTabella()
/*
<option value="" disabled selected>Choose your option</option>
          <option value="1">Option 1</option>
          <option value="2">Option 2</option>
          <option value="3">Option 3</option>


*/

let nodoS1 = document.getElementById("select1")
let nodoS2 = document.getElementById("select2")

function popolaSelect(){

    rimuoviFigli(nodoS1)
    rimuoviFigli(nodoS2)

for (let i = 0; i < books.length; i++) {

    let nodoOpt = document.createElement("option")
    nodoOpt.value = i
    nodoOpt.textContent =  "Pos: " + (i+1) + " " + books[i].titolo

    

    let nodoOpt1 = document.createElement("option")
    nodoOpt1.value = i
    nodoOpt1.textContent =   "Pos: " + (i+1) + " " + books[i].titolo
    
    nodoS1.appendChild(nodoOpt)
    nodoS2.appendChild(nodoOpt1)
}

var elems = document.querySelectorAll('select');
    var instances = M.FormSelect.init(elems);


}

popolaSelect()

let btn = document.getElementById("btn")

btn.onclick = cambia

function cambia(){

    let l1 = parseInt(document.getElementById("select1").value)
    let l2 = parseInt(document.getElementById("select2").value)
    // assegniamo a book il libro presente nella lista in posizione l2
    // assegniamo all'elemento della lista in posizione l2 l'emento della lista in posizione l1
    // assegniamo all'elemento della lista in posizione l1 la variabile book
    let book = books[l2]

    books[l2] = books[l1]

    books[l1] = book

    popolaTabella()
    popolaSelect()
}

function rimuoviFigli (nodo) {
 while (nodo.childNodes.length > 0) {

 nodo.removeChild(nodo.firstChild);
 }}

let btn1 = document.getElementById("btn1")
btn1.onclick = aggiungi


function aggiungi(){

    let titolo = document.getElementById("titolo").value
    let autore = document.getElementById("autore").value
    let anno = document.getElementById("anno").value
    let url = document.getElementById("url").value
    let posizione = document.getElementById("posizione").value

    if (titolo != "" && autore != "" && anno != "" && url != "" && posizione >= 1 && posizione<= 5) {
     
    //alert(titolo+  autore + anno + url + posizione)

    let l1 = new libro(titolo, autore, anno, url)
    books[posizione-1] = l1
    popolaTabella()
    popolaSelect()}

    else alert("Devi compilare tutti i campi")

}



/*let scelta = 0
do {
    scelta = prompt("cosa vuoi fare: ")
    if (scelta == 1) {
        
        let titolo = prompt("Inserisci il titolo: ")
        let autore = prompt("Inserisci l'autore: ")
        let anno = prompt("Inserisci l'anno: ")
        let b1 = new libro(titolo, autore, anno)
        books.push(b1)
    }
    else if (scelta == 2) {
        let trovato = false
        let autore = prompt("Inserisci l'autore: ")
        for (let i = 0; i < books.length; i++) {
            if (autore == books[i].autore) {
                console.log(books[i])
                trovato = true
            }
        }
     if (!trovato){
         console.log("Autore non trovato")
     }   
        
        
    }
    else if (scelta == 3){
         for (let i = 0; i < books.length; i++) {
            console.log(books[i])
             
    }
    }
    
    
    
    
}

while (scelta != 0)


*/
}
    </script>
</head>
<body>
    <div class="container">
        <h1>La mia top five</h1>
        <div class="input-field col s12">
            <select id = "select1">
              
            </select>
            <label>Seleziona la prima canzone</label>
          </div>
          <hr>
          <div class="input-field col s12">
            <select id = "select2">
              
            </select>
            <label>Seleziona la seconda canzone</label>
          </div>

          <button id = "btn">Cambia posizione</button>
    <table>
        <thead>
          <tr>
            <th>Posizione</th>
              <th>Titolo</th>
              <th>Autore</th>
              <th>Anno di pubblicazione</th>
              <th>Immagine</th>
          </tr>
        </thead>

        <tbody id = "tab">
         
         
        </tbody>
      </table> 
<h3>
    Aggiungi una canzone alla classifica
</h3>
      Titolo:
      <br>
      <input type = "text" required id = "titolo" value = "">
      <br>
      Autore:
      <br>
      <input type = "text" required id = "autore" value = "">
      <br>
      Anno:
      <br>
      <input type = "text" required id = "anno" value = "">
      <br>
      Url:
      <br>

      <input type = "text" required id = "url" value = "">
      <br>
      Posizione:
      <br>
      <input type = "number" required id = "posizione" min="1" max="5" value = "5">
      <br>
      <button id = "btn1">Aggiungi</button>
     
    </div>
</body>
</html>